<!DOCTYPE html>
<html>
<head>
  <title>My Profile ‚Äî Dead Poets</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Cormorant+Garamond:wght@300;400;500&display=swap');

:root {
  --black: #0a0a0a;
  --dark: #111;
  --white: #f5f5f5;
  --gray: #aaa;
  --border: #222;
  --gold: #d4c295;
}

body {
  font-family: 'Cormorant Garamond', serif;
  background: var(--black);
  color: var(--white);
  padding: 20px;
}

h2, h3, h4 {
  font-family: 'Playfair Display', serif;
  letter-spacing: 0.5px;
}

.profile-header {
  background: var(--dark);
  padding: 25px;
  border-radius: 10px;
  margin-bottom: 20px;
  border: 1px solid var(--border);
}

.profile-header h3 {
  margin: 0;
  font-size: 26px;
}

.profile-header p {
  margin: 6px 0;
  color: var(--gray);
  font-size: 16px;
}

.stats {
  display: flex;
  gap: 15px;
  margin-top: 15px;
}

.stat-card {
  background: #141414;
  padding: 12px 18px;
  border-radius: 8px;
  border: 1px solid var(--border);
  font-family: 'Playfair Display', serif;
  font-size: 16px;
}

.poem-card {
  background: #121212;
  padding: 18px;
  border-radius: 10px;
  margin-bottom: 15px;
  border: 1px solid var(--border);
}

.poem-card h4 {
  margin-top: 0;
  font-family: 'Playfair Display', serif;
}

.poem-card p {
  color: var(--gray);
  font-size: 16px;
}

@media (max-width: 768px) {
  body { padding: 8px; }
  .stats { flex-direction: column; }
  .stat-card { width: 100%; text-align: center; }
  .profile-header { text-align: center; }
}
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 65px;
  background: #111;
  border-top: 1px solid #222;
  display: flex;
  justify-content: space-around;
  align-items: center;
  font-family: 'Playfair Display', serif;
  z-index: 1000;
}

.bottom-nav div {
  text-align: center;
  color: #f5f5f5;
  font-size: 20px;
  cursor: pointer;
  width: 25%;
  padding-top: 5px;
}

.bottom-nav span {
  display: block;
  font-size: 12px;
  color: #ccc;
  margin-top: 2px;
}

.bottom-nav div:hover {
  color: #d4c295; /* gold accent */
}

</style>

</head>
<body>

<h2>My Profile</h2>

<div id="profile"></div>

<h3>My Poems</h3>
<div id="poems"></div>

<script>
  // ‚úÖ Smart API URL (auto switches for localhost & Vercel)
  const API = window.location.hostname === "localhost"
    ? "http://localhost:5000"
    : "/api";

  const userId = localStorage.getItem("user_id");

  // üö´ Safety check
  if (!userId) {
    window.location.href = "/";
  }

  async function loadProfile() {
    const res = await fetch(`${API}/profile/${userId}`);
    const data = await res.json();

    document.getElementById("profile").innerHTML = `
      <div class="profile-header">
        <h3>${data.user.name}</h3>
        <p>${data.user.email}</p>

        <div class="stats">
          <div class="stat-card">Poems: ${data.poems}</div>
          <div class="stat-card">Total Likes: ${data.likes}</div>
        </div>
      </div>
    `;
  }

  async function loadMyPoems() {
    const res = await fetch(`${API}/user-poems/${userId}`);
    const poems = await res.json();

    const container = document.getElementById("poems");
    container.innerHTML = "";

    poems.forEach(p => {
      container.innerHTML += `
        <div class="poem-card">
          <h4>${p.title}</h4>
          <p>${p.content}</p>
        </div>
      `;
    });
  }

  loadProfile();
  loadMyPoems();
</script>
<div class="bottom-nav">
  <div onclick="window.location.href='home.html'">üè†<span>Home</span></div>
  <div onclick="window.location.href='profile.html'">üë§<span>Profile</span></div>
  <div onclick="window.location.href='/'">üö™<span>Logout</span></div>
</div>

</body>
</html>
